// Generated by CoffeeScript 1.10.0
var drawEconByCountryChart;

drawEconByCountryChart = function(options) {
  var activeCategory, activeValue, arc, arcTween, chart_height, chart_width, container, countries, d3_array, data, employment_cats, employment_cats_concat, format, height, in_work_colours, in_work_colours_domain, in_work_colours_range, isDefault, key, margin, my, onInitDone, onMouseOver, out_of_work_colours, out_of_work_colours_domains, out_of_work_range, outerArc, percFormat, pie, pointPercFormat, ref, ref1, trimCountryString, width, y0;
  container = options.container, data = options.data, isDefault = options.isDefault, onMouseOver = options.onMouseOver, activeCategory = options.activeCategory, activeValue = options.activeValue, onInitDone = options.onInitDone;
  my = {};
  width = (ref = $(container).width()) != null ? ref : 800;
  height = (ref1 = $(container).height()) != null ? ref1 : 550;
  margin = {
    top: 20,
    right: 20,
    bottom: 20,
    left: 20
  };
  chart_width = width - margin.left - margin.right;
  chart_height = height - margin.top - margin.bottom;
  format = d3.format('.2s');
  percFormat = d3.format(',.0%');
  pointPercFormat = d3.format(',.2%');
  d3_array = data.percentages;
  countries = data.countries;
  employment_cats = data.employment_cats_pretty;
  employment_cats_concat = data.employment_cats_concat;
  key = function(d) {
    return d.country;
  };
  in_work_colours_domain = ["Employee", "Self employed"];
  in_work_colours_range = ['#74c476', '#98df8a'];
  in_work_colours = d3.scale.ordinal().domain(in_work_colours_domain).range(in_work_colours_range);
  out_of_work_colours_domains = ["Unemployed", "Retired", "Student", "Other", "Looking after home/family", "Long-term sick/disabled"];
  out_of_work_range = ['#C54E58', '#D6616B', '#B33742', '#E47982', '#F38F97', '#FDABB1'];
  out_of_work_colours = d3.scale.ordinal().domain(out_of_work_colours_domains).range(out_of_work_range);
  trimCountryString = function(str) {
    if (str.indexOf('Antarctica') > -1) {
      return 'Oceanian countries';
    } else if (str.indexOf('EU countries') > -1) {
      return 'EU countries';
    } else if (str.indexOf('Africa') > -1) {
      return 'African countries';
    } else if (str.indexOf('Rest of Europe') > -1) {
      return 'Non-EU European countries';
    } else if (str.indexOf('United Kingdom') > -1) {
      return 'United Kingdom';
    } else if (str.indexOf('Americas') > -1) {
      return 'Americas & Carribean';
    } else if (str.indexOf('Middle') > -1) {
      return 'Asia & Middle East';
    }
  };
  arc = d3.svg.arc().outerRadius(r * 0.3).innerRadius(r * 0.6);
  outerArc = d3.svg.arc().outerRadius(r * 0.7).innerRadius(r * 0.8);
  y0 = d3.scale.linear().domain([0, 1]).range([0, 0.5 * chart_height]);
  pie = d3.layout.pie().sort(null).value(function(d) {
    return d.count;
  });
  arcTween = function(a) {
    var i;
    i = d3.interpolate(this._current, a);
    this._current = i(0);
    return function(t) {
      return arc(i(t));
    };
  };
  my.init = function() {
    var main_group, svg;
    svg = d3.select('.econ-country-donut-svg');
    main_group = svg.select('.main-group');
    return main_group.attr('transform', "translate(" + (chart_width * 0.5) + ", " + (chart_height * 0.5) + "), rotate(90)");
  };
  my.update = function() {
    var main_bottom_group, main_top_group, svg;
    svg = d3.select('.econ-country-svg');
    main_top_group = svg.select('.main-group-top');
    return main_bottom_group = svg.select('.main-group-bottom');
  };
  my.width = function(value) {
    if (!arguments.length) {
      return width;
    }
    width = value;
    return my;
  };
  my.height = function(value) {
    if (!arguments.length) {
      return height;
    }
    height = value;
    return my;
  };
  return my;
};

module.exports = drawEconByCountryChart;

//# sourceMappingURL=econ-activity-country-donut.map
