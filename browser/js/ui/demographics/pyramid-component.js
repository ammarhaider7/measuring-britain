// Generated by CoffeeScript 1.10.0
var Controls, FancySelect, PyramidComponent, React, Table, d3, data, drawPyramid, value_options;

React = require('react');

d3 = require('d3');

Controls = require('../chart-controls.js');

Table = require('./pyramid-table.js');

data = require('./data/pyramid-chart-controls.js');

FancySelect = require('react-select');

drawPyramid = require('./d3/pyramid.js');

value_options = {
  districts: data.districts,
  ethnicities: data.ethnic_groups,
  religions: data.religions,
  regions: data.regions
};

PyramidComponent = React.createClass({displayName: "PyramidComponent",
  componentWillMount: function() {
    return this.props.fetchPyramidData(null);
  },
  componentDidUpdate: function() {
    var pyramid, ref, ref1;
    pyramid = drawPyramid({
      container: this.refs.pyramidSvg,
      ages: this.props.data.bars.ages,
      bar_males: this.props.data.bars.males,
      bar_females: this.props.data.bars.females,
      bar_males_perc: this.props.data.bars.malesPerc,
      bar_females_perc: this.props.data.bars.femalesPerc,
      outline_males: (ref = this.props.data.outline.males) != null ? ref : null,
      outline_females: (ref1 = this.props.data.outline.females) != null ? ref1 : null
    });
    if (this.props.data.bars.ages != null) {
      return pyramid();
    }
  },
  render: function() {
    return React.createElement("div", {
      "className": "col-xs-12 col-sm-8 mt-medium"
    }, React.createElement(Controls, React.__spread({}, this.props, {
      "categories": data.category_options,
      "values": value_options
    })), React.createElement("div", {
      "className": "pyramid mt-medium"
    }, React.createElement("svg", {
      "className": "pyramid-svg",
      "style": {
        width: '100%',
        height: '550px'
      },
      "ref": "pyramidSvg"
    }, React.createElement("g", {
      "className": "main-group"
    }, React.createElement("g", {
      "className": "left-group"
    }), React.createElement("g", {
      "className": "right-group"
    })), React.createElement("g", {
      "className": "overlay-group"
    }), React.createElement("g", {
      "className": "ticks-group"
    }, React.createElement("g", {
      "className": "y axis"
    }), React.createElement("g", {
      "className": "x axis left"
    }))), React.createElement("p", null, (this.props.isFetching ? 'fetching..' : 'done')), ((function() {

      /* unless @props.data.bars.length is 0
      		  			<ul className="mb-left">
      			  			<h3>Bars data</h3>
      		  				{ for item, i in @props.data.bars
      		  					<li key={ i }>{ item.c_age.description + " : " + item.obs_value.value }</li>
      		  				}
      		  			</ul>
      		  		}
      		  		{ unless @props.data.outline.length is 0
      		  			<ul>
      		  				<h3>Outline data</h3>
      		  				{ for item, i in @props.data.outline
      		  					<li key={ i }>{ item.c_age.description + " : " + item.obs_value.value }</li>
      		  				}
      		  			</ul>
       */
    })())));
  }
});

module.exports = PyramidComponent;
